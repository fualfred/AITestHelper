### 注册和登录系统需求说明

#### 注册功能详细需求及校验规则

1. **用户信息收集**
   - **用户名**：
     - 校验长度：6至20个字符。
     - 检查是否包含非法字符（仅允许字母、数字、下划线）。
     - 确认用户名的唯一性，避免重复注册。
   - **密码**：
     - 强制要求至少包含一个大写字母、一个小写字母、一个数字和一个特殊字符。
     - 密码长度不少于8位。
     - 不得使用常见弱密码（如“12345678”、“password”等）。
   - **电子邮箱**：
     - 必须符合标准电子邮件格式。
     - 验证邮箱的唯一性，防止重复注册。
     - 发送验证邮件以激活账户。
   - **手机号（可选）**：
     - 符合国际或国内电话号码的标准格式。
     - 通过发送短信验证码进行真实性验证。
     - 同一手机号只能注册一次。
   - **安全问题及答案**：
     - 安全问题的答案不得为空，并且有一定长度限制（例如不少于4个字符）。

2. **验证码机制**
   - 在注册过程中使用图形验证码或短信验证码来防止自动化注册行为。

3. **用户协议与隐私政策**
   - 用户必须同意服务条款和隐私政策才能完成注册流程。

4. **账户激活**
   - 通过电子邮件或手机短信发送激活链接/代码以激活账户，确保账户的有效性和安全性。

5. **错误处理**
   - 提供明确的提示信息指导用户修正输入错误，例如重复的用户名或邮箱地址时给予具体的提示信息。

#### 登录功能详细需求及校验规则

1. **基本登录**
   - 支持通过用户名/邮箱+密码的方式进行登录。

2. **记住我**
   - 提供“记住我”的选项，以便用户下次访问时自动登录。

3. **忘记密码**
   - 提供密码找回功能，通常通过邮件或手机号进行身份验证后重置密码。

4. **登录尝试限制**
   - 设置连续登录失败次数上限（例如5次），超过后锁定账户一段时间或者直到通过额外的身份验证（如回答安全问题、发送重置邮件/短信）。

5. **双因素认证(2FA)**
   - 在启用2FA的情况下，除了输入密码外，还需要输入由手机应用程序生成的一次性密码（OTP）或回复短信验证码。

6. **会话管理**
   - 设置合理的会话有效期（如30分钟不活动自动注销）。
   - 对于重要操作（如修改密码、资金转账等），应在执行前重新验证用户身份。

7. **设备识别与通知**
   - 记录用户的常用登录设备，并在检测到新设备登录时向用户发送警告通知。

8. **退出功能**
   - 提供明显的注销选项，确保用户能够安全地退出账户。

这些详细的校验规则旨在提高系统的安全性和用户体验。定期审查和更新这些校验规则是必要的，以应对新的安全威胁和技术发展。